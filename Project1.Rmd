---
title: "STA 106 Project 1"
author: "Group 13"
date: "2024-02-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, warning=FALSE}
library(pwr)
library(ggplot2)
library(dplyr)
```

```{r}
# Read in data
senic = read.csv("senic.csv")
```


# Introduction

- [senic dataset info](https://rpubs.com/ismaelisak/SENIC-Analysis)



# Exploratory Data Analysis

```{r}
# Boxplot of means
senic %>% 
  ggplot(aes(x = Region, y = Length)) + 
  geom_boxplot() + 
  labs(x = "Region", 
       y = "Length (days)", 
       title = "Length of Hospital Stay by Region") +
  theme(plot.title = element_text(hjust = 0.5))

```




# Diagnostics

- Isabella

```{r}
#outliers
CO3 = which(senic$Region=="NE" & senic$Length > 15)
the.model = lm(Length ~ Region,data = senic)
senic$ei = the.model$residuals
nt = nrow(senic) #Calculates the total sample size
a = length(unique(senic$Region)) #Calculates the value of a
SSE = sum(senic$ei^2) #Sums and squares the errors (finds SSE)
MSE = SSE/(nt-a) #Finds MSE
eij.star = the.model$residuals/sqrt(MSE)
alpha = 0.05
t.cutoff= qt(1-alpha/(2*nt), nt-a)
CO.eij = which(abs(eij.star) > t.cutoff)
CO.eij
rij = rstandard(the.model)
CO.rij = which(abs(rij) > t.cutoff)
outliers = CO3
new.data = senic[-outliers,]
new.model = lm(Length ~ Region,data = new.data)

``` 

```{r}
#normality 

qqnorm(new.model$residuals)
qqline(new.model$residuals)
ei = new.model$residuals
the.SWtest = shapiro.test(ei)
the.SWtest
```

```{r}
# constant variance

plot(new.model$fitted.values, new.model$residuals, main = "Errors vs. Group Means",xlab = "Group Means",ylab = "Errors",pch = 19)
abline(h = 0,col = "purple")
boxplot(ei ~ Region, data = new.data)
library(car)
the.BFtest = leveneTest(ei~ Region, data=new.data, center=median)
p.val = the.BFtest[[3]][1]
p.val
```

# Analysis

## ANOVA

## Confidence Interval

# Interpretation

# Conclusion


# Appendix

```{r ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```

